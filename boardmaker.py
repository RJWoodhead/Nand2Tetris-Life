#
# python3 script to generate Life.asm tables
#

from typing import List

# New version where we can just define stuff as a table and have our new assembler
# generate the code to initialize it.

def board(board:List[str]) -> None:

	print('')
	print(f'${board[0]}(4*32)=\\')

	# for each row in the board (first entry in list is name of board)

	for i in range(1,33):

		# convert row to binary string

		row = board[i].replace(" ","0").replace("*","1")

		# pack 16 cells into each word, format as binary

		words = [ "0b" + row[16*w:16*(w+1)] for w in range(0,4)]
		
		print('  ' + ",".join(words) + (",\\" if i < 32 else ""))

	print('')

#
# Utility functions for generating other tables needed by the Life program
#

def wrap(f:int ,t: int) -> None:

	print(f'\t@Board+{f}')
	print('\tD = M')
	print('\tM = 0')
	print(f'\t@Board+{t}')
	print('\tM = M + D')
	print('')

#
# Generate the default stored tables
#

board([

"Logo.Board",

"****************************************************************" ,
"*                                                              *" ,
"*  ****    *****   **  **  **   **   *****  **   **  *  *****  *" ,
"* **  **  **   **  *** **  **   **  **   ** **   ** *  **      *" ,
"* **      **   **  ******  ** * **  *******  ******     *****  *" ,
"* **  **  **   **  ** ***  *******  **   **      **         ** *" ,
"*  ****    *****   **  **   ** **   **   **  *****      *****  *" ,
"*                                                              *" ,
"*  ****    *****   *** ***  ******             *****   ******* *" ,
"* **  **  **   **  *******  **                **   **  **      *" ,
"* **      *******  ** * **  ******            **   **  *****   *" ,
"* **  **  **   **  **   **  **                **   **  **      *" ,
"*  *****  **   **  **   **  ******             *****   **      *" ,
"*                                                              *" ,
"*   ****            ********    ************    ************   *" ,
"*   ****            ********    ************    ************   *" ,
"*   ****            ********    ************    ************   *" ,
"*   ****              ****      ****            ****           *" ,
"*   ****              ****      ********        ********       *" ,
"*   ****              ****      ********        ********       *" ,
"*   ****              ****      ****            ****           *" ,
"*   ************    ********    ****            ************   *" ,
"*   ************    ********    ****            ************   *" ,
"*   ************    ********    ****            ************   *" ,
"*                                                              *" ,
"*  ****                   *                    *             * *" ,
"* *    *                  *                    *             * *" ,
"* * ** *     * *   ***  ***  **  *   *  **  ** *  **   **  *** *" ,
"* * ****    * * * *  * *  * *  *  * *  **  *   * *  * *   *  * *" ,
"*  *        *   *  ***  ***  **    *    ** *   *  **  *    *** *" ,
"*                                                              *" ,
"****************************************************************"

]
)

board([

"Oscillator.Board",

"     **                                                         " ,
"***  *      ***     ***   ***                                   " ,
"        *  ***                                   *              " ,
"       **         *    * *    *                * *              " ,
"                  *    * *    *               * *               " ,
"  **              *    * *    *         **   *  *           **  " ,
"                    ***   ***           **    * *           **  " ,
"*   *                                          * *              " ,
"*    *              ***   ***                    *              " ,
"  * * *           *    * *    *                                 " ,
"   * * *          *    * *    *                                 " ,
"    *    *        *    * *    *                                 " ,
"     *   *                                                      " ,
"                    ***   ***                                   " ,
"      **                                                        " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                 **                             " ,
"                **               * *       **                   " ,
"                **                 *       **                   " ,
"                                 ***                            " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                 ***                            " ,
"                **                 *                            " ,
"                **               * *                            " ,
"                                 **                             " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,

]
)

board([

"Gliders.Board",

"                                                                " ,
"     *                                                          " ,
"   *   *                                                *       " ,
"        *                                                *      " ,
"   *    *                                              ***      " ,
"    *****                                                       " ,
"                    *                                           " ,
"                     *                                          " ,
"                   ***      **                                  " ,
"                          *    *                                " ,
"                                *                               " ,
"                          *     *                               " ,
"                           ******                               " ,
"                                                                " ,
"                                                    ****        " ,
"                                                   ******       " ,
"                                          *        **** **      " ,
"                                           *           **       " ,
"                                         ***                    " ,
"                                               **               " ,
"      *                                      *            *     " ,
"       *                                                   *    " ,
"     ***                                     *             *    " ,
"                                              **************    " ,
"                                  *                             " ,
"                                   *                            " ,
"                                 ***                ****        " ,
"                                                   ******       " ,
"                                                   **** **      " ,
"                                                       **       " ,
"                                                                " ,
"                                                                " ,

]
)

board([

"Gosper.Glider.Gun",

"                                                                " ,
"                         *                                      " ,
"                       * *                                      " ,
"             **      **            **                           " ,
"            *   *    **            **                           " ,
" **        *     *   **                                         " ,
" **        *   * **    * *                                      " ,
"           *     *       *                                      " ,
"            *   *                                               " ,
"             **                                                 " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                         **                     " ,
"                                         * *                    " ,
"                                           *                    " ,
"                                           **                   " ,
"                                                                " ,

]
)

board([

"Beacon.Maker",

"                               *                                " ,
"                              *                               **" ,
"                             *                               * *" ,
"                            *                               *   " ,
"                           *                               *    " ,
"                          *                               *     " ,
"                         *                               *      " ,
"                        *                               *       " ,
"                       *                               *        " ,
"                      *                               *         " ,
"                     *                               *          " ,
"                    *                               *           " ,
"                   *                               *            " ,
"                  *                               *             " ,
"                 *                               *              " ,
"                *                               *               " ,
"               *                               *                " ,
"              *                               *                 " ,
"             *                               *                  " ,
"            *                               *                   " ,
"           *                               *                    " ,
"          *                               *                     " ,
"         *                               *                      " ,
"        *                               *                       " ,
"       *                               *                        " ,
"      *                               *                         " ,
"     *                               *                          " ,
"    *                               *                           " ,
" ***                               *                            " ,
"   *                              *                             " ,
"   *                             *                              " ,
"                                *                               " ,

]
)

board([

"Blinker.Puffer",

"                                                                " ,
"                                                                " ,
"        *                                                       " ,
"      *   *                                                     " ,
"     *                                                          " ,
"     *    *                                             **      " ,
"     *****                                             ** ****  " ,
"                                                        ******  " ,
"                                                         ****   " ,
"                                                                " ,
"      **                                                        " ,
"     ** ***                                                     " ,
"      ****   *** *** *** *** *** *** *** *** *** *** *** ***    " ,
"       **                                                       " ,
"                                                                " ,
"          **                                                    " ,
"        *    *                                                  " ,
"       *                                                        " ,
"       *     *                                                  " ,
"       ******                                                   " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,

]
)


print("Guard cell update code (unwrapped)")

wrap(0,2176)
wrap(65,2113)
wrap(2178,130)
wrap(2243,67)

for i in range(1,65):
	wrap(0+i,2112+i)
	wrap(2178+i,66+i)

for i in range(1,32):
	wrap(0+66*i,64+66*i)
	wrap(65+66*i,1+66*i)

print("Row Offset Table into Board (manually wrap this in assembler file)")

print("$Board.Row(32)=" + ",".join([f"Board+{r*66+67}" for r in range(0,32)]))